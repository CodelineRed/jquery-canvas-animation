!function(s){s.fn.canvasAnimation=function(e){var a,t=this,e=s.extend({steps:[],timeout:0,reset_duration:500,infinity:!0,autoplay:!0,controls:!0,controls_fa:null,controls_wrapper:".controls",play_button:".play",pause_button:".pause",reset_button:".reset",fullscreen_button:".fullscreen",class_done:"done",class_wait:"wait",class_wrap:"canvas-animation",controls_template:'<div class="controls"><div class="play #PLAY#"></div><div class="pause #PAUSE#"></div><div class="reset #RESET#"></div><div class="fullscreen #FULLSCREEN#"></div></div>',callback_play:null,callback_done:null,callback_wait:null},e),l=e.infinity,n=[],c=-1;switch(t.wrap('<div class="'+e.class_wrap+'"></div>'),parseInt(e.controls_fa)){case 4:case 5:var o="fa";5===parseInt(e.controls_fa)&&(o="fas"),e.controls_template=e.controls_template.replace("#PLAY#",o+" fa-play"),e.controls_template=e.controls_template.replace("#PAUSE#",o+" fa-pause"),e.controls_template=e.controls_template.replace("#RESET#",o+" fa-stop"),e.controls_template=e.controls_template.replace("#FULLSCREEN#",o+" fa-expand");break;default:e.controls_template=e.controls_template.replace("#PLAY#",""),e.controls_template=e.controls_template.replace("#PAUSE#",""),e.controls_template=e.controls_template.replace("#RESET#",""),e.controls_template=e.controls_template.replace("#FULLSCREEN#","")}e.controls&&t.closest("."+e.class_wrap).append(e.controls_template);var r=function(s){s&&s()},i=function(s){s.requestFullscreen?s.requestFullscreen():s.mozRequestFullScreen?s.mozRequestFullScreen():s.msRequestFullscreen?s.msRequestFullscreen():s.webkitRequestFullscreen&&s.webkitRequestFullscreen()},u=function(){var a=e.timeout;n=[],t.hasClass(e.class_done)&&_(),t.hasClass(e.class_done)&&(t.removeClass(e.class_done),a+=e.reset_duration),t.removeClass(e.class_wait),r(e.callback_play),s.each(e.steps,function(s,l){if(c<s){var o=setTimeout(function(){c=s,t.addClass(l.addClass),t.removeClass(l.removeClass),e.steps.length-1===s&&p(l.duration)},a);a+=l.duration,n.push(o)}else c===s&&p(l.duration)})},p=function(s){a=setTimeout(function(){t.addClass(e.class_done),e.infinity?u():r(e.callback_done)},s)},_=function(){s.each(e.steps,function(s,e){t.removeClass(e.addClass)}),c=-1},d=function(l){n.length>0&&(s.each(n,function(s,e){clearTimeout(n[s])}),l&&_(),t.addClass(e.class_wait),r(e.callback_wait),"undefined"!=typeof a&&clearTimeout(a))};e.autoplay?u():(t.addClass(e.class_wait),r(e.callback_wait)),t.click(function(){e.infinity=l,(t.hasClass(e.class_done)||t.hasClass(e.class_wait))&&u()}),t.next(e.controls_wrapper).find(e.play_button).click(function(){e.infinity=l,(t.hasClass(e.class_done)||t.hasClass(e.class_wait))&&u()}),t.next(e.controls_wrapper).find(e.pause_button).click(function(){e.infinity=!1,d(!1)}),t.next(e.controls_wrapper).find(e.reset_button).click(function(){e.infinity=!1,d(!0),t.hasClass(e.class_done)&&(_(),t.removeClass(e.class_done),t.addClass(e.class_wait),r(e.callback_wait))}),t.next(e.controls_wrapper).find(e.fullscreen_button).click(function(){i(t[0])})}}(jQuery);