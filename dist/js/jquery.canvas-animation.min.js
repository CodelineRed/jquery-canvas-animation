!function(s){s.fn.canvasAnimation=function(e){var a=this,e=s.extend({steps:[],timeout:0,reset_duration:500,autoplay:!0,controls_wrapper:".controls",play_button:".play",reset_button:".reset",fullscreen_button:".fullscreen",class_done:"done",class_wait:"wait",callback_play:null,callback_done:null,callback_wait:null},e),l=function(s){s&&s()},t=function(s){s.requestFullscreen?s.requestFullscreen():s.mozRequestFullScreen?s.mozRequestFullScreen():s.msRequestFullscreen?s.msRequestFullscreen():s.webkitRequestFullscreen&&s.webkitRequestFullscreen()},n=function(){var t=e.timeout;c(),a.hasClass(e.class_done)&&(a.removeClass(e.class_done),t+=e.reset_duration),a.removeClass(e.class_wait),l(e.callback_play),s.each(e.steps,function(s,n){setTimeout(function(){a.addClass(n.addClass),a.removeClass(n.removeClass)},t),t+=n.duration,e.steps.length-1===s&&setTimeout(function(){a.addClass(e.class_done),l(e.callback_done)},t)})},c=function(){s.each(e.steps,function(s,e){a.removeClass(e.addClass)})};e.autoplay?n():(a.addClass(e.class_wait),l(e.callback_wait)),a.click(function(){(a.hasClass(e.class_done)||a.hasClass(e.class_wait))&&n()}),a.next(e.controls_wrapper).find(e.play_button).click(function(){(a.hasClass(e.class_done)||a.hasClass(e.class_wait))&&n()}),a.next(e.controls_wrapper).find(e.reset_button).click(function(){a.hasClass(e.class_done)&&(c(),a.addClass(e.class_wait),a.removeClass(e.class_done),l(e.callback_wait))}),a.next(e.controls_wrapper).find(e.fullscreen_button).click(function(){t(a[0])})}}(jQuery);