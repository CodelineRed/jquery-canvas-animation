!function(f){f.fn.canvasAnimation=function(t){if("undefined"!==this.attr("id")){var s,i=this,l=[],o=-1,a=(t=f.extend({steps:[],timeout:0,resetDuration:500,infinite:!0,autoplay:!0,controls:!0,editor:{enable:!1},faVersion:null,faPrefix:"fas",controlsWrapper:".jca-controls",backwardButton:".jca-backward",playButton:".jca-play",pauseButton:".jca-pause",resetButton:".jca-reset",forwardButton:".jca-forward",expandButton:".jca-expand",editButton:".jca-edit",classDone:"jca-done",classWait:"jca-wait",classForward:"jca-forward",classBackward:"jca-backward",classWrap:"jca-wrap",controlsTemplate:'<div class="jca-controls"><div class="jca-backward"></div><div class="jca-play"></div><div class="jca-pause"></div><div class="jca-reset"></div><div class="jca-forward"></div><div class="jca-expand"></div><div class="jca-edit"></div></div>',onPlay:null,onDone:null,onWait:null},t)).infinite,e=f(t.controlsTemplate);switch(t.editor.enable=t.editor.enable&&"function"==typeof f.fn.canvasAnimationEditor,i.wrap('<div class="'+t.classWrap+'"></div>'),parseInt(t.faVersion)){case 4:case 5:f("html").addClass("jca-fontawesome"),e.find(t.backwardButton).append('<i class="'+t.faPrefix+' fa-step-backward"></i>'),e.find(t.playButton).append('<i class="'+t.faPrefix+' fa-play"></i>'),e.find(t.pauseButton).append('<i class="'+t.faPrefix+' fa-pause"></i>'),e.find(t.resetButton).append('<i class="'+t.faPrefix+' fa-stop"></i>'),e.find(t.forwardButton).append('<i class="'+t.faPrefix+' fa-step-forward"></i>'),e.find(t.expandButton).append('<i class="'+t.faPrefix+' fa-expand"></i>'),e.find(t.editButton).append('<i class="'+t.faPrefix+' fa-edit"></i>')}t.controls&&(t.editor.enable||e.find(t.editButton).remove(),i.closest("."+t.classWrap).append(e.clone()));var c=function(a){a&&a()},n=function(){var n=t.timeout;l=[],i.hasClass(t.classDone)&&d(),i.hasClass(t.classForward)&&o--,i.hasClass(t.classDone)&&(i.removeClass(t.classDone),n+=t.resetDuration),i.removeClass(t.classWait),c(t.onPlay),f.each(t.steps,function(a,s){if(o<a){var e=setTimeout(function(){o=a,i.addClass(s.addClass),i.removeClass(s.removeClass),"boolean"==typeof s.pause&&!0===s.pause&&(t.infinite=!1,u(!1)),t.steps.length-1===a&&r(s.duration)},n);"number"!=typeof s.duration&&(s.duration=500),n+=s.duration,l.push(e)}})},r=function(a){s=setTimeout(function(){i.addClass(t.classDone),i.hasClass(t.classWait)||(t.infinite?n():c(t.onDone))},a)},d=function(){f.each(t.steps,function(a,s){i.removeClass(s.addClass)}),o=-1},u=function(a){0<l.length&&(f.each(l,function(a,s){clearTimeout(l[a])}),a&&d(),i.addClass(t.classWait),c(t.onWait),void 0!==s&&clearTimeout(s))};t.autoplay?n():(i.addClass(t.classWait),c(t.onWait)),t.editor.enable||i.click(function(){t.infinite=a,(i.hasClass(t.classDone)||i.hasClass(t.classWait))&&n()}),i.next(t.controlsWrapper).find(t.backwardButton).click(function(){(i.hasClass(t.classDone)||i.hasClass(t.classWait))&&(i.hasClass(t.classForward)&&o--,i.removeClass(t.classForward),i.addClass(t.classBackward),o<0&&(o=t.steps.length),o===t.steps.length?f.each(t.steps,function(a,s){i.addClass(s.addClass),i.removeClass(s.removeClass)}):(i.removeClass(t.steps[o].addClass),i.addClass(t.steps[o].removeClass)),o--)}),i.next(t.controlsWrapper).find(t.playButton).click(function(){t.infinite=a,(i.hasClass(t.classDone)||i.hasClass(t.classWait))&&n()}),i.next(t.controlsWrapper).find(t.pauseButton).click(function(){t.infinite=!1,u(!1)}),i.next(t.controlsWrapper).find(t.resetButton).click(function(){t.infinite=!1,u(!0),d(),i.removeClass(t.classDone),i.addClass(t.classWait),c(t.onWait)}),i.next(t.controlsWrapper).find(t.forwardButton).click(function(){(i.hasClass(t.classDone)||i.hasClass(t.classWait))&&(i.hasClass(t.classBackward)&&o++,i.addClass(t.classForward),i.removeClass(t.classBackward),(o>t.steps.length||-1===o)&&(o=0),o===t.steps.length?d():(i.addClass(t.steps[o].addClass),i.removeClass(t.steps[o].removeClass)),o++)}),i.next(t.controlsWrapper).find(t.expandButton).click(function(){var a;(a=i[0]).requestFullscreen?a.requestFullscreen():a.mozRequestFullScreen?a.mozRequestFullScreen():a.msRequestFullscreen?a.msRequestFullscreen():a.webkitRequestFullscreen&&a.webkitRequestFullscreen()}),t.editor.enable&&(i.canvasAnimationEditor(t.editor),i.next(t.controlsWrapper).find(t.editButton).click(function(){f(".jca-editor").is(":visible")?f(".jca-editor").hide():f(".jca-editor").show()}))}}}(jQuery);