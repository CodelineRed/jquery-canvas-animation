!function(b){b.fn.canvasAnimationEditor=function(o){var r=this,e=[],i="",d="",p="",m="",u=0,v=0,a=(o=b.extend({enable:!1,labels:{top:"top",left:"left",width:"width",height:"height",newItemBlank:"New Item (Blank)",newItemExt:"New Item (Extended)",selectCss:"Select CSS",selectHtml:"Select HTML",removeItem:"Remove Item",className:"CSS class name",parentWidth:"Parent width in px",parentHeight:"Parent height in px",itemWidth:"Item width in px",itemHeight:"Item height in px",itemTop:"Item offset top in px",itemLeft:"Item offset left in px",confirmAppendPrepend:"OK = append item / Cancel = prepend item"},template:'<div class="jca-editor"><div class="jca-container"><div class="jca-col jca-cord-dimension"><div class="jca-box"><div class="jca-label jca-top"></div><div class="jca-label jca-left"></div><div class="jca-label jca-width"></div><div class="jca-label jca-height"></div><input type="number" step="0.1" name="jca_top" /><input type="number" step="0.1" name="jca_left" /><input type="number" step="0.1" name="jca_width" /><input type="number" step="0.1" name="jca_height" /></div></div><div class="jca-col jca-selector-breadcrumb"></div><div class="jca-col"><div id="jca-html"></div><div id="jca-css"></div></div><div class="jca-col"><input type="button" name="jca_new_item" value=""/> <input type="button" name="jca_new_item_ext" value=""/><br/><input type="button" name="jca_html" value=""/> <input type="button" name="jca_css" value="Select CSS"/><br/><br/><input type="button" name="jca_remove_item" value=""/><br/></div></div></div>'},o),b(o.template));function h(a,e,t,s,n){var c=b('<div class="'+a+'"></div>');c.css("position","absolute"),c.css("top",e),c.css("left",t),c.css("width",s),c.css("height",n),c.attr("data-hash",j()),c.css("background-color",f());var l='[data-hash="'+c.attr("data-hash")+'"]';if(b("head").append("<style>"+l+"{background-color:"+f()+"}</style>"),a.length){if(b(".jca-active-element").length)var i=b(".jca-active-element").parent();else i=r;confirm(o.labels.confirmAppendPrepend)?i.append(c):i.prepend(c),b(l).click()}}function s(a){a.toggleClass("jca-active-element");var e=n(a)+" {<br/>";return e+="&nbsp;&nbsp;&nbsp;&nbsp;top: "+a.css("top")+";<br>",e+="&nbsp;&nbsp;&nbsp;&nbsp;left: "+a.css("left")+";<br>",e+="&nbsp;&nbsp;&nbsp;&nbsp;width: "+a.css("width")+";<br>",e+="&nbsp;&nbsp;&nbsp;&nbsp;height: "+a.css("height")+";<br>",e+="}",a.toggleClass("jca-active-element"),e}function n(a){var e=a.attr("id"),t=a.attr("class"),s="";return a.hasClass("jca-active-element")&&(a.toggleClass("jca-active-element"),t=a.attr("class"),a.toggleClass("jca-active-element")),void 0!==e&&e.length&&(s+="#"+e),void 0!==t&&t.length&&(s+="."+t.replace(/ /gi,".")),s}function f(){for(var a="#",e=0;e<6;e++)a+="0123456789ABCDEF"[Math.floor(16*Math.random())];return a}function c(a){var e=a.attr("id"),t="";return(void 0===e||void 0!==e&&e!==r.attr("id"))&&(t=c(a.parent())),t+'<a href="'+a.data("hash")+'">'+n(a)+"</a> > "}function j(){for(var a="";(a=f())in e;);return e[a]=1,a}function t(){r.hide();var a=b(".jca-active-element");a.css("top",b('[name="jca_top"]').val()+"%"),a.css("left",b('[name="jca_left"]').val()+"%"),a.css("width",b('[name="jca_width"]').val()+"%"),a.css("height",b('[name="jca_height"]').val()+"%"),b("#jca-css").html(s(a)),r.show()}function l(a){var e,t,s=document,n=s.getElementById(a);s.body.createTextRange?((e=document.body.createTextRange()).moveToElementText(n),e.select()):window.getSelection&&(t=window.getSelection(),(e=document.createRange()).selectNodeContents(n),t.removeAllRanges(),t.addRange(e))}a.find(".jca-label.jca-top").attr("data-label",o.labels.top),a.find(".jca-label.jca-left").attr("data-label",o.labels.left),a.find(".jca-label.jca-width").attr("data-label",o.labels.width),a.find(".jca-label.jca-height").attr("data-label",o.labels.height),a.find('[name="jca_new_item"]').val(o.labels.newItemBlank),a.find('[name="jca_new_item_ext"]').val(o.labels.newItemExt),a.find('[name="jca_css"]').val(o.labels.selectCss),a.find('[name="jca_html"]').val(o.labels.selectHtml),a.find('[name="jca_remove_item"]').val(o.labels.removeItem),b("body").prepend(a),r.attr("data-hash",j()),b(".jca-selector-breadcrumb").html(c(r)),b("*",r).each(function(){b(this).attr("data-hash",j())}),b(r).click(function(a){var e,t=b(a.target);r.hide(),b("*",r).removeClass("jca-active-element"),b("*",r).css("background-color",""),void 0===t.attr("id")||void 0!==t.attr("id")&&t.attr("id")!==r.attr("id")?(b('[name="jca_top"]').val(parseFloat(t.css("top"))),b('[name="jca_left"]').val(parseFloat(t.css("left"))),b('[name="jca_width"]').val(parseFloat(t.css("width"))),b('[name="jca_height"]').val(parseFloat(t.css("height"))),t.addClass("jca-active-element"),t.css("background-color",f()),b("#jca-css").html(s(t)),b("#jca-html").html(((e=(e=t).clone()).removeAttr("data-hash"),e.removeAttr("style"),e.removeClass("jca-active-element"),e[0].outerHTML.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&#39;").replace(/</g,"&lt;").replace(/>/g,"&gt;")))):(b('[name="jca_top"]').val(""),b('[name="jca_left"]').val(""),b('[name="jca_width"]').val(""),b('[name="jca_height"]').val(""),b("#jca-css").html(""),b("#jca-html").html("")),r.show(),b(".jca-selector-breadcrumb").html(c(t))}),b(".jca-cord-dimension input").change(function(){t()}),b(".jca-cord-dimension input").keyup(function(){t()}),b('[name="jca_new_item"]').click(function(){h(prompt(o.labels.className),"0","0","25%","25%")}),b('[name="jca_new_item_ext"]').click(function(){var a=prompt(o.labels.className),e=i=parseInt(prompt(o.labels.parentWidth,i)),t=d=parseInt(prompt(o.labels.parentHeight,d)),s=m=parseInt(prompt(o.labels.itemWidth,m)),n=p=parseInt(prompt(o.labels.itemHeight,p)),c=u=parseInt(prompt(o.labels.itemTop,u)),l=v=parseInt(prompt(o.labels.itemLeft,v));h(a,(100*c/t).toFixed(1)+"%",(100*l/e).toFixed(1)+"%",(100*s/e).toFixed(1)+"%",(100*n/t).toFixed(1)+"%")}),b('[name="jca_remove_item"]').click(function(){b(".jca-active-element").length&&confirm("Are you sure to remove "+n(b(".jca-active-element"))+"?")&&(b(".jca-active-element").remove(),r.click())}),b('[name="jca_css"]').click(function(){l("jca-css")}),b('[name="jca_html"]').click(function(){l("jca-html")}),b(".jca-selector-breadcrumb").on("click","a",function(a){a.preventDefault(),b('[data-hash="'+b(this).attr("href")+'"]').click()})}}(jQuery),function(u){u.fn.canvasAnimation=function(n){var e,c=this,a=(n=u.extend({steps:[],timeout:0,resetDuration:500,infinity:!0,autoplay:!0,controls:!0,editorConfig:{enable:!1},fontawesomeVersion:null,controlsWrapper:".jca-controls",backwardButton:".jca-backward",playButton:".jca-play",pauseButton:".jca-pause",resetButton:".jca-reset",forwardButton:".jca-forward",expandButton:".jca-expand",editButton:".jca-edit",classDone:"jca-done",classWait:"jca-wait",classForward:"jca-forward",classBackward:"jca-backward",classWrap:"jca-wrap",controlsTemplate:'<div class="jca-controls"><div class="jca-backward"></div><div class="jca-play"></div><div class="jca-pause"></div><div class="jca-reset"></div><div class="jca-forward"></div><div class="jca-expand"></div><div class="jca-edit"></div></div>',onPlay:null,onDone:null,onWait:null},n)).infinity,l=[],i=-1,t=u(n.controlsTemplate);switch(c.wrap('<div class="'+n.classWrap+'"></div>'),parseInt(n.fontawesomeVersion)){case 4:case 5:var s="fa";5===parseInt(n.fontawesomeVersion)&&(s="fas"),u("html").addClass("jca-fontawesome"),t.find(n.backwardButton).append('<i class="'+s+' fa-step-backward"></i>'),t.find(n.playButton).append('<i class="'+s+' fa-play"></i>'),t.find(n.pauseButton).append('<i class="'+s+' fa-pause"></i>'),t.find(n.resetButton).append('<i class="'+s+' fa-stop"></i>'),t.find(n.forwardButton).append('<i class="'+s+' fa-step-forward"></i>'),t.find(n.expandButton).append('<i class="'+s+' fa-expand"></i>'),t.find(n.editButton).append('<i class="'+s+' fa-edit"></i>')}n.controls&&c.closest("."+n.classWrap).append(t.clone());var o=function(a){a&&a()},r=function(){var s=n.timeout;l=[],c.hasClass(n.classDone)&&p(),c.hasClass(n.forwardButton.substring(1))&&i--,c.hasClass(n.classDone)&&(c.removeClass(n.classDone),s+=n.resetDuration),c.removeClass(n.classWait),o(n.onPlay),u.each(n.steps,function(a,e){if(i<a){var t=setTimeout(function(){i=a,c.addClass(e.addClass),c.removeClass(e.removeClass),"boolean"==typeof e.pause&&!0===e.pause&&(n.infinity=!1,m(!1)),n.steps.length-1===a&&d(e.duration)},s);"number"!=typeof e.duration&&(e.duration=500),s+=e.duration,l.push(t)}})},d=function(a){e=setTimeout(function(){c.addClass(n.classDone),c.hasClass(n.classWait)||(n.infinity?r():o(n.onDone))},a)},p=function(){u.each(n.steps,function(a,e){c.removeClass(e.addClass)}),i=-1},m=function(a){0<l.length&&(u.each(l,function(a,e){clearTimeout(l[a])}),a&&p(),c.addClass(n.classWait),o(n.onWait),void 0!==e&&clearTimeout(e))};n.autoplay?r():(c.addClass(n.classWait),o(n.onWait)),n.editorConfig.enable||c.click(function(){n.infinity=a,(c.hasClass(n.classDone)||c.hasClass(n.classWait))&&r()}),c.next(n.controlsWrapper).find(n.backwardButton).click(function(){(c.hasClass(n.classDone)||c.hasClass(n.classWait))&&(c.hasClass(n.classForward)&&i--,c.removeClass(n.classForward),c.addClass(n.classBackward),i<0&&(i=n.steps.length),i===n.steps.length?u.each(n.steps,function(a,e){c.addClass(e.addClass),c.removeClass(e.removeClass)}):(c.removeClass(n.steps[i].addClass),c.addClass(n.steps[i].removeClass)),i--)}),c.next(n.controlsWrapper).find(n.playButton).click(function(){n.infinity=a,(c.hasClass(n.classDone)||c.hasClass(n.classWait))&&r()}),c.next(n.controlsWrapper).find(n.pauseButton).click(function(){n.infinity=!1,m(!1)}),c.next(n.controlsWrapper).find(n.resetButton).click(function(){n.infinity=!1,m(!0),p(),c.removeClass(n.classDone),c.addClass(n.classWait),o(n.onWait)}),c.next(n.controlsWrapper).find(n.forwardButton).click(function(){(c.hasClass(n.classDone)||c.hasClass(n.classWait))&&(c.hasClass(n.classBackward)&&i++,c.addClass(n.classForward),c.removeClass(n.classBackward),(i>n.steps.length||-1===i)&&(i=0),i===n.steps.length?p():(c.addClass(n.steps[i].addClass),c.removeClass(n.steps[i].removeClass)),i++)}),c.next(n.controlsWrapper).find(n.expandButton).click(function(){var a;(a=c[0]).requestFullscreen?a.requestFullscreen():a.mozRequestFullScreen?a.mozRequestFullScreen():a.msRequestFullscreen?a.msRequestFullscreen():a.webkitRequestFullscreen&&a.webkitRequestFullscreen()}),n.editorConfig.enable&&(c.canvasAnimationEditor(n.editorConfig),c.next(n.controlsWrapper).find(n.editButton).click(function(){u(".jca-editor").is(":visible")?u(".jca-editor").hide():u(".jca-editor").show()}))}}(jQuery);