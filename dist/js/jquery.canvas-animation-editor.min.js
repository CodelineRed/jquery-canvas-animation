!function(f){f.fn.canvasAnimationEditor=function(r){var o=this,t=[],s="",m="",d="",p="",h=0,v=0,e=(r=f.extend({enable:!1,labels:{top:"top",left:"left",width:"width",height:"height",newItemBlank:"New Item (Blank)",newItemExt:"New Item (Extended)",selectCss:"Select CSS",selectHtml:"Select HTML",removeItem:"Remove Item",className:"CSS class name",parentWidth:"Parent width in px",parentHeight:"Parent height in px",itemWidth:"Item width in px",itemHeight:"Item height in px",itemTop:"Item offset top in px",itemLeft:"Item offset left in px",confirmAppendPrepend:"OK = append item / Cancel = prepend item"},template:'<div class="jca-editor"><div class="jca-container"><div class="jca-col jca-cord-dimension"><div class="jca-box"><div class="jca-label jca-top"></div><div class="jca-label jca-left"></div><div class="jca-label jca-width"></div><div class="jca-label jca-height"></div><input type="number" step="0.1" name="jca_top" /><input type="number" step="0.1" name="jca_left" /><input type="number" step="0.1" name="jca_width" /><input type="number" step="0.1" name="jca_height" /></div></div><div class="jca-col jca-selector-breadcrumb"></div><div class="jca-col"><div id="jca-html"></div><div id="jca-css"></div></div><div class="jca-col"><input type="button" name="jca_new_item" value=""/> <input type="button" name="jca_new_item_ext" value=""/><br/><input type="button" name="jca_html" value=""/> <input type="button" name="jca_css" value="Select CSS"/><br/><br/><input type="button" name="jca_remove_item" value=""/><br/></div></div></div>'},r),f(r.template));function j(e,t,a,c,n){var l=f('<div class="'+e+'"></div>');l.css("position","absolute"),l.css("top",t),l.css("left",a),l.css("width",c),l.css("height",n),l.attr("data-hash",u()),l.css("background-color",b());var i='[data-hash="'+l.attr("data-hash")+'"]';if(f("head").append("<style>"+i+"{background-color:"+b()+"}</style>"),e.length){if(f(".jca-active-element").length)var s=f(".jca-active-element").parent();else s=o;confirm(r.labels.confirmAppendPrepend)?s.append(l):s.prepend(l),f(i).click()}}function c(e){e.toggleClass("jca-active-element");var t=n(e)+" {<br/>";return t+="&nbsp;&nbsp;&nbsp;&nbsp;top: "+e.css("top")+";<br>",t+="&nbsp;&nbsp;&nbsp;&nbsp;left: "+e.css("left")+";<br>",t+="&nbsp;&nbsp;&nbsp;&nbsp;width: "+e.css("width")+";<br>",t+="&nbsp;&nbsp;&nbsp;&nbsp;height: "+e.css("height")+";<br>",t+="}",e.toggleClass("jca-active-element"),t}function n(e){var t=e.attr("id"),a=e.attr("class"),c="";return e.hasClass("jca-active-element")&&(e.toggleClass("jca-active-element"),a=e.attr("class"),e.toggleClass("jca-active-element")),void 0!==t&&t.length&&(c+="#"+t),void 0!==a&&a.length&&(c+="."+a.replace(/ /gi,".")),c}function b(){for(var e="#",t=0;t<6;t++)e+="0123456789ABCDEF"[Math.floor(16*Math.random())];return e}function l(e){var t=e.attr("id"),a="";return(void 0===t||void 0!==t&&t!==o.attr("id"))&&(a=l(e.parent())),a+'<a href="'+e.data("hash")+'">'+n(e)+"</a> > "}function u(){for(var e="";(e=b())in t;);return t[e]=1,e}function a(){o.hide();var e=f(".jca-active-element");e.css("top",f('[name="jca_top"]').val()+"%"),e.css("left",f('[name="jca_left"]').val()+"%"),e.css("width",f('[name="jca_width"]').val()+"%"),e.css("height",f('[name="jca_height"]').val()+"%"),f("#jca-css").html(c(e)),o.show()}function i(e){var t,a,c=document,n=c.getElementById(e);c.body.createTextRange?((t=document.body.createTextRange()).moveToElementText(n),t.select()):window.getSelection&&(a=window.getSelection(),(t=document.createRange()).selectNodeContents(n),a.removeAllRanges(),a.addRange(t))}e.find(".jca-label.jca-top").attr("data-label",r.labels.top),e.find(".jca-label.jca-left").attr("data-label",r.labels.left),e.find(".jca-label.jca-width").attr("data-label",r.labels.width),e.find(".jca-label.jca-height").attr("data-label",r.labels.height),e.find('[name="jca_new_item"]').val(r.labels.newItemBlank),e.find('[name="jca_new_item_ext"]').val(r.labels.newItemExt),e.find('[name="jca_css"]').val(r.labels.selectCss),e.find('[name="jca_html"]').val(r.labels.selectHtml),e.find('[name="jca_remove_item"]').val(r.labels.removeItem),f("body").prepend(e),o.attr("data-hash",u()),f(".jca-selector-breadcrumb").html(l(o)),f("*",o).each(function(){f(this).attr("data-hash",u())}),f(o).click(function(e){var t,a=f(e.target);o.hide(),f("*",o).removeClass("jca-active-element"),f("*",o).css("background-color",""),void 0===a.attr("id")||void 0!==a.attr("id")&&a.attr("id")!==o.attr("id")?(f('[name="jca_top"]').val(parseFloat(a.css("top"))),f('[name="jca_left"]').val(parseFloat(a.css("left"))),f('[name="jca_width"]').val(parseFloat(a.css("width"))),f('[name="jca_height"]').val(parseFloat(a.css("height"))),a.addClass("jca-active-element"),a.css("background-color",b()),f("#jca-css").html(c(a)),f("#jca-html").html(((t=(t=a).clone()).removeAttr("data-hash"),t.removeAttr("style"),t.removeClass("jca-active-element"),t[0].outerHTML.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&#39;").replace(/</g,"&lt;").replace(/>/g,"&gt;")))):(f('[name="jca_top"]').val(""),f('[name="jca_left"]').val(""),f('[name="jca_width"]').val(""),f('[name="jca_height"]').val(""),f("#jca-css").html(""),f("#jca-html").html("")),o.show(),f(".jca-selector-breadcrumb").html(l(a))}),f(".jca-cord-dimension input").change(function(){a()}),f(".jca-cord-dimension input").keyup(function(){a()}),f('[name="jca_new_item"]').click(function(){j(prompt(r.labels.className),"0","0","25%","25%")}),f('[name="jca_new_item_ext"]').click(function(){var e=prompt(r.labels.className),t=s=parseInt(prompt(r.labels.parentWidth,s)),a=m=parseInt(prompt(r.labels.parentHeight,m)),c=p=parseInt(prompt(r.labels.itemWidth,p)),n=d=parseInt(prompt(r.labels.itemHeight,d)),l=h=parseInt(prompt(r.labels.itemTop,h)),i=v=parseInt(prompt(r.labels.itemLeft,v));j(e,(100*l/a).toFixed(1)+"%",(100*i/t).toFixed(1)+"%",(100*c/t).toFixed(1)+"%",(100*n/a).toFixed(1)+"%")}),f('[name="jca_remove_item"]').click(function(){f(".jca-active-element").length&&confirm("Are you sure to remove "+n(f(".jca-active-element"))+"?")&&(f(".jca-active-element").remove(),o.click())}),f('[name="jca_css"]').click(function(){i("jca-css")}),f('[name="jca_html"]').click(function(){i("jca-html")}),f(".jca-selector-breadcrumb").on("click","a",function(e){e.preventDefault(),f('[data-hash="'+f(this).attr("href")+'"]').click()})}}(jQuery);