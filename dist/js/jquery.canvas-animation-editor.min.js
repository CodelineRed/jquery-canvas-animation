!function(x){x.fn.canvasAnimationEditor=function(o){var d=this,a=[],i=d.width().toFixed(0),m=d.height().toFixed(0),r="",p="",h=0,j=0;o=x.extend(!0,{},{enable:!1,decimal:2,draggableItems:!0,wrapper:".jca-editor-container",labels:{top:"top",left:"left",width:"width",height:"height",newItem:"New: ",newItemBlank:"Blank",newItemExt:"Extended",select:"Select: ",selectCss:"CSS",selectHtml:"HTML",remove:"Remove: ",removeItem:"Item",removeStyle:"Style",className:"CSS class name",parentWidth:"Parent width in px",parentHeight:"Parent height in px",itemWidth:"Item width in px",itemHeight:"Item height in px",itemTop:"Item offset top in px",itemLeft:"Item offset left in px",confirmAppendPrepend:"OK = append item / Cancel = prepend item",confirmRemoveItem:"Are you sure to remove item?",confirmRemoveStyle:"Are you sure to remove style?",alertCanvasId:'Canvas must have attribute "id".'},template:'<div class="jca-editor-container"><div class="jca-container"><div class="jca-col jca-cord-dimension"><div class="jca-box"><div class="jca-label jca-top"></div><div class="jca-label jca-left"></div><div class="jca-label jca-width"></div><div class="jca-label jca-height"></div><input type="number" step="0.01" name="jca_top" /><input type="number" step="0.01" name="jca_left" /><input type="number" step="0.01" name="jca_width" /><input type="number" step="0.01" name="jca_height" /></div></div><div class="jca-col jca-selector-breadcrumb"></div><div class="jca-col jca-code-col"><div id="jca-html"></div><div id="jca-css"></div></div><div class="jca-col jca-button-col"><span class="jca-new"></span><input type="button" name="jca_new_item" value=""/> <input type="button" name="jca_new_item_ext" value=""/><br/><span class="jca-select"></span><input type="button" name="jca_html" value=""/> <input type="button" name="jca_css" value=""/><br/><span class="jca-remove"></span><input type="button" name="jca_remove_item" value=""/> <input type="button" name="jca_remove_style" value=""/><br/><br/><span class="jca-width"></span> <span class="jca-width-val"></span> <span class="jca-height"></span> <span class="jca-height-val"></span><br/><span class="jca-top"></span> <span class="jca-top-val"></span> <span class="jca-left"></span> <span class="jca-left-val"></span></div></div></div>'},o);if("undefined"!==d.attr("id")){x("html").addClass("jca-editor-enable");var e=x(o.template);e.find(".jca-label.jca-top").attr("data-label",o.labels.top),e.find(".jca-label.jca-left").attr("data-label",o.labels.left),e.find(".jca-label.jca-width").attr("data-label",o.labels.width),e.find(".jca-label.jca-height").attr("data-label",o.labels.height),e.find(".jca-button-col .jca-top").text(o.labels.top+":"),e.find(".jca-button-col .jca-left").text(o.labels.left+":"),e.find(".jca-button-col .jca-width").text(o.labels.width+":"),e.find(".jca-button-col .jca-height").text(o.labels.height+":"),e.find('[name="jca_new_item"]').val(o.labels.newItemBlank),e.find('[name="jca_new_item_ext"]').val(o.labels.newItemExt),e.find('[name="jca_css"]').val(o.labels.selectCss),e.find('[name="jca_html"]').val(o.labels.selectHtml),e.find('[name="jca_remove_item"]').val(o.labels.removeItem),e.find('[name="jca_remove_style"]').val(o.labels.removeStyle),e.find(".jca-new").text(o.labels.newItem),e.find(".jca-select").text(o.labels.select),e.find(".jca-remove").text(o.labels.remove),d.parent().append(e),o.decimal<1&&(o.decimal=2),e.find('[name="jca_top"],[name="jca_left"],[name="jca_width"],[name="jca_height"]').attr("step",1/Math.pow(10,o.decimal)),d.attr("data-hash",f()),s(d),u(d),x("*",d).each(function(){x(this).attr({dataHash:f(),dataClass:x(this).attr("class")}),g(x(this))}),x(d).click(function(e){var a=x(e.target);d.hide(),x("*",d).removeClass("jca-active-element"),x("*",d).css("background-color",""),w(a)?(x('[name="jca_top"],[name="jca_left"],[name="jca_width"],[name="jca_height"]').val(""),x("#jca-css,#jca-html").html("")):(x('[name="jca_top"]').val(parseFloat(a.css("top"))),x('[name="jca_left"]').val(parseFloat(a.css("left"))),x('[name="jca_width"]').val(parseFloat(a.css("width"))),x('[name="jca_height"]').val(parseFloat(a.css("height"))),a.addClass("jca-active-element"),a.css("background-color",b()),x("#jca-css").html(c(a)),x("#jca-html").html(l(a))),d.show(),s(a),u(a),i=a.width().toFixed(0),m=a.height().toFixed(0),w(a)||g(a)}),x(".jca-cord-dimension input").change(function(){t()}),x(".jca-cord-dimension input").keyup(function(){t()}),x('[name="jca_new_item"]').click(function(){v(prompt(o.labels.className),"0","0","25%","25%")}),x('[name="jca_new_item_ext"]').click(function(){var e=prompt(o.labels.className),a=i=parseInt(prompt(o.labels.parentWidth,i)),t=m=parseInt(prompt(o.labels.parentHeight,m)),c=p=parseInt(prompt(o.labels.itemWidth,p)),l=r=parseInt(prompt(o.labels.itemHeight,r)),n=h=parseInt(prompt(o.labels.itemTop,h)),s=j=parseInt(prompt(o.labels.itemLeft,j));v(e,(100*n/t).toFixed(o.decimal)+"%",(100*s/a).toFixed(o.decimal)+"%",(100*c/a).toFixed(o.decimal)+"%",(100*l/t).toFixed(o.decimal)+"%")}),x('[name="jca_remove_item"]').click(function(){if(x(".jca-active-element").length&&confirm(o.labels.confirmRemoveItem+" "+n(x(".jca-active-element")))){var e=x(".jca-active-element").parent();x(".jca-active-element").remove(),e.click()}}),x('[name="jca_remove_style"]').click(function(){x(".jca-active-element").length&&confirm(o.labels.confirmRemoveStyle+" "+n(x(".jca-active-element")))&&x(".jca-active-element").attr("style","")}),x('[name="jca_css"]').click(function(){_("jca-css")}),x('[name="jca_html"]').click(function(){_("jca-html")}),x(".jca-selector-breadcrumb").on("click","a",function(e){e.preventDefault(),x('[data-hash="'+x(this).attr("href")+'"]').click()})}else alert(o.labels.alertCanvasId);function v(e,a,t,c,l){var n=x('<div class="'+e+'" data-class="'+e+'"></div>');n.css({position:"absolute",top:a,left:t,width:c,height:l,backgroundColor:b()}),n.attr("data-hash",f());var s='[data-hash="'+n.attr("data-hash")+'"]';if(x("head").append("<style>"+s+"{background-color:"+b()+"}</style>"),e.length){if(x(".jca-active-element").length)var i=x(".jca-active-element");else i=d;confirm(o.labels.confirmAppendPrepend)?i.append(n):i.prepend(n),x(s).click()}g(x(s))}function c(e){return n(e)+" {<br/>&nbsp;&nbsp;&nbsp;&nbsp;top: "+e.css("top")+";<br>&nbsp;&nbsp;&nbsp;&nbsp;left: "+e.css("left")+";<br>&nbsp;&nbsp;&nbsp;&nbsp;width: "+e.css("width")+";<br>&nbsp;&nbsp;&nbsp;&nbsp;height: "+e.css("height")+";<br>}"}function l(e){return('<div class="'+e.data("class")+'"></div>').replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&#39;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function n(e){var a=e.attr("id"),t=e.data("class"),c="";return void 0!==a&&a.length&&(c+="#"+a),void 0!==t&&t.length&&(c+="."+t.replace(/ /gi,".")),c}function b(){for(var e="#",a=0;a<6;a++)e+="0123456789ABCDEF"[Math.floor(16*Math.random())];return e}function f(){for(var e="";e=b(),-1<a.indexOf(e););return a.push(e),e}function s(e){x(".jca-selector-breadcrumb").html(function e(a){var t="";return w(a)||(t=e(a.parent())),t+'<a href="'+a.data("hash")+'">'+n(a)+'</a> <span class="jca-pointer">></span> '}(e))}function u(e){w(e)?x(".jca-button-col .jca-top-val,.jca-button-col .jca-left-val").text("0px;"):(x(".jca-button-col .jca-top-val").text(parseInt(e.css("top")).toFixed(0)+"px;"),x(".jca-button-col .jca-left-val").text(parseInt(e.css("left")).toFixed(0)+"px;")),x(".jca-button-col .jca-width-val").text(e.width().toFixed(0)+"px;"),x(".jca-button-col .jca-height-val").text(e.height().toFixed(0)+"px;")}function g(t){o.draggableItems&&"function"==typeof x.fn.draggable&&!t.hasClass("ui-draggable")&&t.draggable({stop:function(e,a){x("*",d).removeClass("jca-active-element"),t.css("top",(100*parseFloat(t.css("top"))/t.parent().height()).toFixed(o.decimal)+"%"),t.css("left",(100*parseFloat(t.css("left"))/t.parent().width()).toFixed(o.decimal)+"%"),x('[name="jca_top"]').val((100*parseFloat(t.css("top"))/t.parent().height()).toFixed(o.decimal)),x('[name="jca_left"]').val((100*parseFloat(t.css("left"))/t.parent().width()).toFixed(o.decimal)),d.hide(),x('[name="jca_width"]').val(parseFloat(t.css("width"))),x('[name="jca_height"]').val(parseFloat(t.css("height"))),x("#jca-css").html(c(t)),x("#jca-html").html(l(t)),d.show(),s(t),u(t),x(a.helper).hasClass("jca-active-element")||x(a.helper).addClass("jca-active-element")}})}function t(){if(x(".jca-active-element").length){var e=x(".jca-active-element");e.css({top:x('[name="jca_top"]').val()+"%",left:x('[name="jca_left"]').val()+"%",width:x('[name="jca_width"]').val()+"%",height:x('[name="jca_height"]').val()+"%"}),d.hide(),x("#jca-css").html(c(e)),d.show(),u(e)}else x('[name="jca_top"],[name="jca_left"],[name="jca_width"],[name="jca_height"]').val(""),u(d)}function _(e){var a,t,c=document,l=c.getElementById(e);c.body.createTextRange?((a=document.body.createTextRange()).moveToElementText(l),a.select()):window.getSelection&&(t=window.getSelection(),(a=document.createRange()).selectNodeContents(l),t.removeAllRanges(),t.addRange(a))}function w(e){return void 0!==e.attr("id")&&e.attr("id")===d.attr("id")}}}(jQuery);